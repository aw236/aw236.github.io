---
title: "HW11"
author: "Andrew Wong"
date: "February 23, 2016"
output: html_document
geometry: margin=0.25in
fontsize: 10pt
always_allow_html: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Task
Read and summarize "Learning to Discover Social Circles in Ego Networks, Julian McAuley and Jure Leskovec, NIPS 2012"

## Summary
In this paper, we are introduced to the idea of an ego network, which can be thought of as a social structure comprised of individuals with connections amongst them. In particular, this setting presents the canonical problem of automatically discovering the node membership to multiple "circles," with hierarchically nested circles. This problem relates to clustering, network theory, and graph theory. The authors examine this problem in the framework of of ego network with data from Google+, Twitter, and Facebook. An interesting aside is that Dr. Leskovec is one of only a handful of researchers with access to Facebook data.

The authors define a generative model for determining social circles. In particular, they model the probability that a pair of nodes, or individuals, form an edge (are connected), as dependent on exponential of the sum of the inner product of feature vector, $\phi(x,y)$ and a parameter parameter, $\theta_k$, for all $K$ number of circles containing both nodes $x$ and $y$. From the aforementioned sum, we subtract the sum of the inner product of the $\phi(x,y)$ and $\theta_k$ times a trade-off factor, $\alpha_k$. $\alpha_k$ seems to operate as a regularization term that penalizes for larger $k$. The idea is that since the feature vector encodes the similarity between two users and the parameter vector encodes the dimensions of similarity that cause the circle to form, the nodes within a circle should 'look similar' according to $\theta_k$. This is equation 1 from the text,

$$p((x,y) \in E) \propto \text{exp}\left\{\sum\limits_{C_k\supseteq\{x,y\}} \langle\phi(x,y),\theta_k\rangle - \sum\limits_{C_k\not\supseteq\{x,y\}} \alpha_k \langle\phi(x,y),\theta_k\rangle \right\}$$

Given that the edges between nodes, $e=(x,y)$ are generated independently, the probability of an ego-network, $G$, can be written down as the product of positive evidence for all circles and negative evidence against all circles. for a given set of model parameters. The next goal is to maximize the log-likelihood of the probability for an ego network, given by equation 3,

$$l_{\Theta}(G;\mathcal{C}) = \sum\limits_{e\in E} \Phi(e) - \sum\limits_{e \in V x V} \text{log} \left(1+e^{\Phi(e)} \right)$$

In order to maximize the regularized log-likehood given by equation 3, coordinate ascent is used on $\Theta$ and $\mathcal{C}$ to derive equation 6. Since equation 3 is concave in $\theta$, gradient ascent is used to optimize equation 6. The result is the ability to use pseudo-boolean optimization, and the authors note that they used the QPBO software to do this, in order to solve for the $C_k$ that maximizes our log-likelihood. 

After iterating through the coordinate ascent and the gradient ascent optimizations until convergence ($C^{t+1}=C^t$), and regularizing to find sparse, interpretable parameters. The unsupervised nature of this approach means that the authors' method can be run on the full Facebook graph (all of Facebook's data). 

The authors propose using the Bayesian Information Criterion (BIC) for choosing the optimal number of circles, $K$, that minimizes the BIC. I'm not sure why they want to use the BIC for hyperparameter estimation, since it seems that using something like a Dirichlet Process (DP) to discover the number of clusters would be much better than a method like BIC that is prone to overfitting problems. 

In any case, the authors conduct experiments on Google+, Twitter and Facebook data and found that the perfomance of their four different feature sets based on the balanced error rate (BER) and $F_1$ score, was either statistically significantly better (BER) or equivalent ($F_1$) to baselines like multi-assignment clustering, block-LDA, and low-rank embedding. 

This paper introduces a novel method of discovering circles on social networks that improves on existing methods. It seems that this approach of discovering networks in ego networks has applicability in many other areas. Examples include document clustering, where documents might be related to others and belong to hierarchically nested circles. I can also see this applying to circles of related products, and useful to e-commerce companies like Amazon. Also, I think a gaming digital-distribution platform like Steam would also benefit, introducing egos to video games of a given circle, if an ego enjoys a particular game from that circle. Finally, I created a simple, ad-hoc, 3-dimensional, interactive visualization of an ego network below in R and JavaScript (it is only visible in the HTML version of my submission). The labels are meaningless, but the concept of ego networks and social circles/clusters are evident.

```{r echo=FALSE, warning=FALSE, message=FALSE}
library(networkD3)
data(MisLinks, MisNodes)
forceNetwork(Links = MisLinks, Nodes = MisNodes, Source = "source",
             Target = "target", Value = "value", NodeID = "name",
             Group = "group", opacity = 0.4)
```